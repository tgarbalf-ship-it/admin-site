<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‚Ø¯ÙŠÙ… Ø¥Ø¯Ø§Ø±Ø© Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</title>
<style>
body{background:#0f0f0f;color:white;font-family:Arial;text-align:center;margin:0;padding:0;}
.container{max-width:500px;margin:30px auto;background:#1c1c1c;padding:20px;border-radius:20px;box-shadow:0 0 25px #00ff99;}
h2,h3{margin-bottom:15px;text-shadow:0 0 10px #00ff99;}
input,textarea{width:100%;padding:12px;margin:6px 0;border:none;border-radius:10px;background:#222;color:white;}
button{background:#00ff99;border:none;padding:12px;width:100%;border-radius:10px;margin-top:6px;cursor:pointer;font-weight:bold;box-shadow:0 0 10px #00ff99;}
button:hover{background:#00cc77;box-shadow:0 0 15px #00ff77;}
.application{background:#222;padding:10px;margin:10px 0;border-radius:10px;text-align:right;box-shadow:0 0 8px #00ff99;}
.accept{background:green;box-shadow:0 0 8px green;}
.reject{background:red;box-shadow:0 0 8px red;}
.success{background:#003300;padding:10px;border-radius:10px;margin-top:10px;box-shadow:0 0 10px #00ff99;}
.pending{animation:blink 1s infinite;}
@keyframes blink{0%{opacity:1;}50%{opacity:0.4;}100%{opacity:1;}}
.topButton{background:#00ff99;border:none;padding:10px;margin:6px 0;border-radius:8px;cursor:pointer;box-shadow:0 0 8px #00ff99;}
.topButton:hover{background:#00cc77;}
.backBtn{position:fixed;top:10px;left:10px;padding:10px;border-radius:8px;background:#00ff99;cursor:pointer;z-index:1000;box-shadow:0 0 8px #00ff99;}
.backBtn:hover{background:#00cc77;}
</style>
</head>
<body>
<div class="container" id="mainContainer">
<h2>ØªÙ‚Ø¯ÙŠÙ… Ø¥Ø¯Ø§Ø±Ø©</h2>

<div id="applySection">
<input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù…">
<input type="text" id="age" placeholder="Ø§Ù„Ø¹Ù…Ø±">
<textarea id="reason" placeholder="Ø³Ø¨Ø¨ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…"></textarea>
<textarea id="experience" placeholder="Ø®Ø¨Ø±ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©"></textarea>
<textarea id="handling" placeholder="ÙƒÙŠÙ ØªØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ØŸ"></textarea>
<button onclick="submitApp()">Ø¥Ø±Ø³Ø§Ù„</button>
<button onclick="checkStatus()">ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„ØªÙŠ</button>
<button onclick="adminLogin()">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
</div>

<div id="status"></div>
<div id="adminPanel" style="display:none;"></div>
<div id="recordsPanel" style="display:none;"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// Ø¥Ø¹Ø¯Ø§Ø¯ Supabase
const supabaseUrl = "https://ygfbxlasagrnhvrbapiq.supabase.co";
const supabaseKey = "sb_publishable_aBt0lYzYB2-lHZQ8tOU4xg_4GcM-udx";
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

const discordLink = "https://discord.gg/kdy3fkbKX9";
const adminPass = "RUN";

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
async function submitApp(){
  let name = document.getElementById("name").value.trim();
  let age = document.getElementById("age").value.trim();
  let reason = document.getElementById("reason").value.trim();
  let experience = document.getElementById("experience").value.trim();
  let handling = document.getElementById("handling").value.trim();
  if(!name||!age||!reason||!experience||!handling){alert("Ø§ÙƒÙ…Ù„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");return;}
  
  // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø±
  let { data: existing } = await supabase
    .from('Ø·Ù„Ø¨Ø§Øª')
    .select('id')
    .eq('Ø§Ù„Ø§Ø³Ù…', name)
    .single();
  if(existing){alert("Ø§Ù†Øª Ù‚Ø¯Ù…Øª Ù…Ù† Ù‚Ø¨Ù„"); return;}
  
  // Ø£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨
  await supabase.from('Ø·Ù„Ø¨Ø§Øª').insert([{
    Ø§Ù„Ø§Ø³Ù…: name,
    Ø§Ù„Ø¹Ù…Ø±: age,
    Ø³Ø¨Ø¨_Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…: reason,
    Ø§Ù„Ø®Ø¨Ø±Ø©: experience,
    Ø§Ù„ØªØ¹Ø§Ù…Ù„: handling,
    Ø§Ù„Ø­Ø§Ù„Ø©: "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"
  }]);
  
  alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ");
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
async function checkStatus(){
  let name = document.getElementById("name").value.trim();
  if(!name){alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ");return;}
  let { data: app } = await supabase
    .from('Ø·Ù„Ø¨Ø§Øª')
    .select('*')
    .eq('Ø§Ù„Ø§Ø³Ù…', name)
    .single();
  let statusDiv = document.getElementById("status");
  if(!app){statusDiv.innerHTML="Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…"; return;}
  if(app.Ø§Ù„Ø­Ø§Ù„Ø©==="Ù…Ù‚Ø¨ÙˆÙ„"){
    statusDiv.innerHTML=`<div class="success">ğŸ‰ ØªÙ… Ù‚Ø¨ÙˆÙ„Ùƒ!<br>Ø§Ø¶ØºØ· Ù„Ù„Ø¯Ø®ÙˆÙ„:<br><a href="${discordLink}" target="_blank" style="color:#00ff99;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±</a></div>`;
  }else if(app.Ø§Ù„Ø­Ø§Ù„Ø©==="Ù…Ø±ÙÙˆØ¶"){
    statusDiv.innerHTML="âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨Ùƒ";
  }else{
    statusDiv.innerHTML=`<div class="pending">â³ Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>`;
  }
}

// ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
async function adminLogin(){
  let pass = prompt("Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©");
  if(pass!==adminPass){alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙ„Ø·");return;}
  document.getElementById("applySection").style.display="none";
  document.getElementById("adminPanel").style.display="block";
  loadApps();
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
async function loadApps(){
  let panel=document.getElementById("adminPanel");
  panel.innerHTML="<h3>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>";
  panel.innerHTML+='<button class="topButton" onclick="showRecords()">Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙˆÙ†/Ø§Ù„Ù…Ø±ÙÙˆØ¶ÙˆÙ†</button>';
  let { data: apps } = await supabase.from('Ø·Ù„Ø¨Ø§Øª').select('*').eq('Ø§Ù„Ø­Ø§Ù„Ø©','Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  apps.forEach(app=>{
    panel.innerHTML+=`<div class="application" id="app-${app.id}"><b>${app.Ø§Ù„Ø§Ø³Ù…}</b><br>Ø§Ù„Ø¹Ù…Ø±: ${app.Ø§Ù„Ø¹Ù…Ø±}<br>${app.Ø³Ø¨Ø¨_Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…}<br>${app.Ø§Ù„Ø®Ø¨Ø±Ø©}<br>${app.Ø§Ù„ØªØ¹Ø§Ù…Ù„}<br>
    <button class="accept" onclick="updateStatus(${app.id},'Ù…Ù‚Ø¨ÙˆÙ„')">Ù‚Ø¨ÙˆÙ„</button>
    <button class="reject" onclick="updateStatus(${app.id},'Ù…Ø±ÙÙˆØ¶')">Ø±ÙØ¶</button></div>`;
  });
}

// ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
async function updateStatus(id,status){
  await supabase.from('Ø·Ù„Ø¨Ø§Øª').update({Ø§Ù„Ø­Ø§Ù„Ø©:status}).eq('id',id);
  document.getElementById("app-"+id).style.display="none";
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ù…Ø±ÙÙˆØ¶ÙŠÙ†
async function showRecords(){
  document.getElementById("adminPanel").style.display="none";
  let panel=document.getElementById("recordsPanel");
  panel.style.display="block";
  panel.innerHTML='<div class="backBtn" onclick="backToAdmin()">Ø±Ø¬ÙˆØ¹</div><h3>Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙˆÙ† ÙˆØ§Ù„Ù…Ø±ÙÙˆØ¶ÙˆÙ†</h3>';
  let { data: apps } = await supabase.from('Ø·Ù„Ø¨Ø§Øª').select('*').neq('Ø§Ù„Ø­Ø§Ù„Ø©','Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  apps.forEach(app=>{
    panel.innerHTML+=`<div class="application" id="record-${app.id}"><b>${app.Ø§Ù„Ø§Ø³Ù…}</b><br>Ø§Ù„Ø¹Ù…Ø±: ${app.Ø§Ù„Ø¹Ù…Ø±}<br>${app.Ø³Ø¨Ø¨_Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…}<br>${app.Ø§Ù„Ø®Ø¨Ø±Ø©}<br>${app.Ø§Ù„ØªØ¹Ø§Ù…Ù„}<br>Ø§Ù„Ø­Ø§Ù„Ø©: ${app.Ø§Ù„Ø­Ø§Ù„Ø©}<br>
    <button class="accept" onclick="updateStatus(${app.id},'Ù…Ù‚Ø¨ÙˆÙ„')">Ù‚Ø¨ÙˆÙ„</button>
    <button class="reject" onclick="updateStatus(${app.id},'Ù…Ø±ÙÙˆØ¶')">Ø±ÙØ¶</button></div>`;
  });
}

function backToAdmin(){
  document.getElementById("recordsPanel").style.display="none";
  document.getElementById("adminPanel").style.display="block";
}
</script>
</body>
</html>
